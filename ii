local lp = game.Players.LocalPlayer
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local window = library.CreateLib("Keybrew Hub discord.gg/keybrew", "GrapeTheme")
local maintab = window:NewTab("Main")

local New = maintab:NewSection("To work Execute in Infinite Mode + Mobs Fully spawned in")

local function getClosest()
    local dist, thing = math.huge
    for i, v in next, game:GetService("Workspace").Live.NPCs:GetChildren() do
        if v:IsA("Model") and v.Humanoid.Health > 0 then
            local mag =
                (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.HumanoidRootPart.Position).magnitude
            if mag < dist then
                dist = mag
                thing = v
            end
        end
    end
    return thing
end

local TweenService = game:GetService("TweenService")
local noclipE = false
local antifall = false

local function noclip()
    for i, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
        if v:IsA("BasePart") and v.CanCollide == true then
            v.CanCollide = false
            game.Players.LocalPlayer.Character.HumanoidRootPart.Velocity = Vector3.new(0, 0, 0)
        end
    end
end

local function moveto(obj, speed)
    local info =
        TweenInfo.new(
        ((game.Players.LocalPlayer.Character.HumanoidRootPart.Position - obj.Position).Magnitude) / speed,
        Enum.EasingStyle.Linear
    )
    local tween = TweenService:Create(game.Players.LocalPlayer.Character.HumanoidRootPart, info, {CFrame = obj})

    if not game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("BodyVelocity") then
        antifall = Instance.new("BodyVelocity", game.Players.LocalPlayer.Character.HumanoidRootPart)
        antifall.Velocity = Vector3.new(0, 0, 0)
        noclipE = game:GetService("RunService").Stepped:Connect(noclip)
        tween:Play()
    end

    tween.Completed:Connect(
        function()
            antifall:Destroy()
            noclipE:Disconnect()
        end
    )
end

local hrp = game.Players.LocalPlayer.Character.HumanoidRootPart
local npc = getClosest().HumanoidRootPart
-- Main

local Main = maintab:NewSection("Farm")
Main:NewToggle("Auto Attack/Skills", "Toggles the Attacks/Skills on and off.", function(state)
    o = state
    while o do
        task.wait()
                lp.ClientInputEvents.M1:Fire()
                lp.ClientInputEvents.Substitute:Fire()
                game:GetService("VirtualInputManager"):SendKeyEvent(true,Enum.KeyCode.One,false,game)
                game:GetService("VirtualInputManager"):SendKeyEvent(true,Enum.KeyCode.Two,false,game)
                game:GetService("VirtualInputManager"):SendKeyEvent(true,Enum.KeyCode.Three,false,game)
                game:GetService("VirtualInputManager"):SendKeyEvent(true,Enum.KeyCode.Four,false,game)
        end
    end)
    local function getDist(P, M)
        local dist = (P.Position - M.Position).magnitude
        return dist
    end
Main:NewToggle("Auto-Farm Infinite", "Toggles the Auto-Farm on and off.", function(state)
    oo = state
    while oo do
        task.wait()
        if getDist(npc, hrp) < 500 then
            pcall(function()
                moveto(getClosest().HumanoidRootPart.CFrame + Vector3.new(0,0,0),500)
                task.wait(2)
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = getClosest()
            end)    
        end
        end
    end)

    Main:NewToggle("Auto Press Continue", "Auto Press Continue", function(state)
        b = state
        while b do
            task.wait()
            lp.ClientInputEvents.DoubleJump:Fire()
            end
        end)

    Main:NewToggle("Infinite Jump", "Toggles the Auto-Farm on and off.", function(state)
        ooo = state
        while ooo do
            task.wait()
            lp.ClientInputEvents.DoubleJump:Fire()
            end
        end)

    

-- Settings

local settingstab = window:NewTab("Settings")
local settingsuisec = settingstab:NewSection("UI Settings")
settingsuisec:NewKeybind("Toggle UI Keybind", "Toggles the UI with the use of a key.", Enum.KeyCode.RightControl, function()
	library:ToggleUI()
end)

--anti afk

local vu = game:GetService("VirtualUser")
game:GetService("Players").LocalPlayer.Idled:connect(function()
   vu:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
   wait(1)
   vu:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
end)
